<!DOCTYPE html>
<html>
<head>
    <title>UI表格测试</title>
    <script type="text/javascript" src="../js/jquery.min.js"></script>

    <script type="text/javascript" src="../src/yayoi-ui-core.js" data-init="startYayoi" data-devMode="true"></script>
    <script type="text/javascript" src="../js/qunit.js"></script>
    <link rel="stylesheet" href="../css/qunit.css" />
    <link rel="stylesheet" href="../css/yayoi-ui.css" />
    <link rel="stylesheet" href="../css/font/font-awesome.min.css">
</head>
<body>
    <h1>UI表格测试</h1>
    <div id='gridId' style='width: 1200px; height: auto; margin:auto;'></div>
    <div id="qunit"></div>
    <div id="qunit-fixture"></div>
    <script type="text/javascript">
    function startYayoi() {
        yayoi.util.require("yayoi.ui.grid.Grid");
        yayoi.util.require("yayoi.proxy.HttpProxy");
    }
    $(function(){
        grid = new yayoi.ui.grid.Grid({
            title: "表格测试",
            showIndex: true,
            checkable: true,
            selector: '#gridId',
            rowPath: "/users",
            columns: [
                {
                    type: "text", format: "text", title: "Whole Name", router: "firstName", width: "160px", decorate: function(rowData) {
                        return rowData.lastName +" "+ rowData.firstName
                    }
                }, {
                    type: "text", format: "text", title: "Gender", router: "gender", width: "200px", decorate: function(rowData) {
                        if (rowData.gender=="male") {
                            return "男";
                        } else {
                            return "女";
                        }
                    }
                }, {
                    type: "text", format: "text", title: "BirthDate", router: "birthDate", width: "200px",
                }, {
                    type: "text", format: "text", title: "Email", router: "email", width: "200px",
                }, {
                    type: "text", format: "text", title: "IdCard", router: "idCard", width: "200px",
                }, {
                    type: "text", format: "text",  title: "Address", width: "200px", decorate: function(rowData) {
                        return rowData.address.city + "." + rowData.address.street
                    }
                }
            ],
            onRefresh: function(page) {
                var model = grid.getModel();
                store.url = "/json/grid-data-" + page.pageNo + ".json"
                store.load();
            }
        });

        var store = new yayoi.proxy.HttpProxy({
            url: "/json/grid-data-1.json",
            method: "get",
            async: false,
            parseData: function(result) {
                var o = (result.code == 1)? result.data : {};
                o.page = {};
                store.logger.info(o);
                return o;
            },
            success: function() {
                grid.setModel(store.getModel(), "/");
            }
        });
        store.load();
    })
    </script>
</body>
</html>
